var linen=function(){function p(j){function m(c){c=function(a){a=a.split("\n");var e=[],b;for(b in a){var d=/^(\*+|#+)\s+(.*)/.exec(a[b]);if(d){types={"*":"ul","#":"ol"};e.push({type:types[d[1][0]],indent:d[1].length,content:d[2]})}}return e}(c);return{type:c[0].type,extended:false,attrs:[],content:c}}function l(c){var a=[],e="",b=0,d=c[0];if(d=="f"&&c[b+1]=="n")e="f"+c[b+1];if(d=="*"||d=="#")return m(c);if(d=="|"){c=c.split("\n");a=[];for(var f in c){e=c[f].replace(/^\|/,"").replace(/\|$/,"");a.push(e.split("|"))}return{type:"table",
extended:false,attrs:[],content:a}}if(d=="b")e="b"+c[++b];if(d=="h")e="h"+c[++b];if(d=="p")if(c.slice(b,b+3)=="pre"){b+=2;e="pre"}else e="p";for(b++;b<c.length;b++){d=c[b];if(d==">")a.push(">");else if(d=="=")a.push("=");else if(d=="<")if(c[b+1]==">"){b++;a.push("<>")}else a.push("<");else if(d=="("){for(f=b;c[b++]!==")";);a.push(c.slice(f,b--))}else if(d=="["){for(f=b;c[b++]!=="]";);a.push(c.slice(f,b--))}else if(d=="{"){for(f=b;c[b++]!=="}";);a.push(c.slice(f,b--))}else return d=="."?{type:e,extended:c[b+
1]==".",attrs:a,content:c.slice(++b,c.length).trim()}:{type:"p",attrs:[],extended:false,content:c.trim()}}return null}j=j.split(/\n\n+/);var g=[],h;for(h in j){var i=l(j[h]);i&&g.push(i)}return g}function n(j){return j.replace(/--/,"&#8212;").replace(/\n/,"<br/>").replace(/"([^"]*)"/,"&#8220;$1&#8221;").replace(/'([^']*)'/,"&#8216;$1&#8217;").replace(/'/,"&#8217;").replace(/ - /," &endash; ").replace(/\.\.\./,"&#8230;").replace(/\(r\)/,"&#174;").replace(/\(tm\)/,"&#8482;").replace(/\(c\)/,"&#169;").replace(/([A-Z]{2,})\(([^)]+)\)/,
'<span class="caps"><acronym title="$2">$1</acronym></span>').replace(/([A-Z]{2,})/,'<span class="caps">$1</span>').replace(/\?\?([^\?]+)\?\?/,"<cite>$1</cite>").replace(/%([^%]+)%/,"<span>$1</span>").replace(/\*([^\*]+)\*/,"<strong>$1</strong>").replace(/\*\*([^\*]+)\*\*/,"<b>$1</b>").replace(/_([^_]+)_/,"<em>$1</em>").replace(/__([^_]+)__/,"<i>$1</i>").replace(/\+([^\+]+)\+/,"<ins>$1</ins>").replace(/-([^-]+)-/,"<del>$1</del>").replace(/\^([^\^]+)\^/,"<sup>$1</sup>").replace(/~([^~]+)~/,"<sub>$1</sub>")}
function q(j){function m(h){if(h.type=="ol"||h.type=="ul"){for(var i=h.content,c=1,a=[],e=a,b=[],d=0;d<i.length;d++){var f=i[d];f.content=n(f.content);if(f.indent>c)for(var k=0;k<f.indent-c;k++){b.push(e);var o=[];e.push(o);e=o}if(f.indent<c)for(k=0;k<c-f.indent;k++)e=b.pop();e.push(f);c=f.indent}return{type:h.type,content:a,classes:"",id:"",lang:"",style:"",alignment:""}}if(h.type=="table")return{type:"table",content:h.content,classes:"",id:"",lang:"",style:"",alignment:""};i={type:h.type,content:n(h.content),
classes:"",id:"",lang:"",style:"",alignment:""};for(c in h.attrs){a=h.attrs[c];if(a[0]=="("){a=a.replace(/^\(/,"").replace(/\)$/,"").split("#");i.classes=i.classes==""?a[0]:i.classes+" "+a[0];if(a.length>1&&i.id=="")i.id=a[1]}else if(a[0]=="[")i.lang=a.replace(/^\[/,"").replace(/\]$/,"");else if(a[0]=="{")i.style=a.replace(/^\{/,"").replace(/\}$/,"");else if(i.alignment==""){if(a==">")i.alignment="right";if(a=="<")i.alignment="left";if(a=="=")i.alignment="center";if(a=="<>")i.alignment="justify"}}return i}
var l=[],g;for(g in j)l.push(m(j[g]));return l}function r(j){function m(g){function h(a){var e="";if(a.classes)e+='class="'+a.classes+'" ';if(a.id)e+='id="'+a.id+'" ';if(a.align)a.style="text-align: "+a.align+"; "+a.style;if(a.style)e+='style="'+a.style+'" ';if(a.lang)e+='lang="'+a.lang+'" ';return e}function i(a){var e="<table "+h(a)+">",b;for(b in a.content){var d=a.content[b];e+="<tr>";for(var f in d)e+="<td>"+d[f]+"</td>";e+="</tr>"}e+="</table>";return e}function c(a){function e(b){var d="<"+
b[0].type+">",f;for(f in b){var k=b[f];if(k.type){d+="<li>"+k.content;if(b[f+1]&&b[f+1].type==undefined)d+=e(b[++f]);d+="</li>"}else d+=e(k)}d+="</"+b[0].type+">";return d}return e(a.content)}switch(g.type){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":return"<"+g.type+" "+h(g)+">"+g.content+"</"+g.type+">";case "bq":return"<blockquote "+h(g)+"><p>"+g.content+"</p></blockquote>";case "fn":return"<p"+h(g)+"><sup>"+g.number+"</sup>"+g.content+"</p>";case "p":return"<p "+h(g)+">"+g.content+
"</p>";case "bc":return"<pre "+h(g)+"><code>"+g.content+"</code></pre>";case "pre":return"<pre "+h(g)+">"+g.content+"</pre>";case "table":return i(g);case "ul":case "ol":return c(g)}}ret="";for(var l in j)ret+=m(j[l])+"\n";return ret}return function(j){return r(q(p(j)))}}();if(typeof exports!="undefined"){exports.linen=linen;exports.textilize=linen};
